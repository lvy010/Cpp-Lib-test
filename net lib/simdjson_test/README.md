# SimdJSON æµ‹è¯•é›†åˆ

è¿™æ˜¯ä¸€ä¸ªå…¨é¢çš„ SimdJSON åº“æµ‹è¯•é¡¹ç›®ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ SimdJSON è¿›è¡Œé«˜æ€§èƒ½ JSON è§£æçš„å„ç§åœºæ™¯å’ŒæŠ€æœ¯ã€‚SimdJSON æ˜¯ä¸€ä¸ªæå¿«çš„ JSON è§£æåº“ï¼Œåˆ©ç”¨ SIMD æŒ‡ä»¤å®ç°äº†å“è¶Šçš„æ€§èƒ½ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
simdjson_test/
â”œâ”€â”€ README.md                    # æœ¬æ–‡æ¡£
â”œâ”€â”€ test_simdjson.cpp           # åŸºç¡€ JSON è§£æå…¥é—¨ç¤ºä¾‹
â”œâ”€â”€ chain/                      # é“¾å¼è°ƒç”¨æµ‹è¯•
â”‚   â”œâ”€â”€ README.md              # é“¾å¼è°ƒç”¨è¯¦ç»†è¯´æ˜
â”‚   â”œâ”€â”€ Makefile              # ç¼–è¯‘é…ç½®
â”‚   â”œâ”€â”€ demo.sh               # æ¼”ç¤ºè„šæœ¬
â”‚   â”œâ”€â”€ simdjson_chain_test.cpp
â”‚   â””â”€â”€ simdjson_chain_comprehensive_test.cpp
â”œâ”€â”€ error/                      # é”™è¯¯å¤„ç†æµ‹è¯•
â”‚   â”œâ”€â”€ simdjson_error_test.cpp
â”‚   â”œâ”€â”€ simdjson_exception_test.cpp
â”‚   â”œâ”€â”€ simdjson_fatal_error_test.cpp
â”‚   â””â”€â”€ simdjson_simple_error_test.cpp
â””â”€â”€ stream/                     # æµå¼å¤„ç†æµ‹è¯•
    â”œâ”€â”€ Makefile
    â””â”€â”€ simdjson_ndjson_stream_test.cpp
```

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
- **åŸºç¡€è§£æ**: JSON æ–‡æ¡£çš„åŸºæœ¬è§£æå’Œç±»å‹æ£€æŸ¥
- **é“¾å¼è®¿é—®**: ä½¿ç”¨ ondemand API è¿›è¡Œé«˜æ•ˆçš„åµŒå¥—æ•°æ®è®¿é—®
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶å’Œå¼‚å¸¸ç®¡ç†
- **æµå¼å¤„ç†**: NDJSON (æ¢è¡Œåˆ†éš”çš„ JSON) æ–‡æ¡£æµå¤„ç†

### æ€§èƒ½ä¼˜åŠ¿
- ğŸƒâ€â™‚ï¸ **æé«˜æ€§èƒ½**: åˆ©ç”¨ SIMD æŒ‡ä»¤åŠ é€Ÿè§£æ
- ğŸ“ˆ **å†…å­˜é«˜æ•ˆ**: å»¶è¿Ÿè§£æå’Œé›¶æ‹·è´è®¾è®¡
- ğŸ”„ **æµå¼å¤„ç†**: æ”¯æŒå¤§å‹ JSON æ–‡ä»¶çš„æµå¼è§£æ
- ğŸ›¡ï¸ **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥

## ğŸ“‹ å‰ç½®è¦æ±‚

### ç³»ç»Ÿä¾èµ–
- C++17 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ç¼–è¯‘å™¨
- CMake 3.15+ (å¯é€‰ï¼Œç”¨äºä»æºç æ„å»º)
- SimdJSON åº“

### å®‰è£… SimdJSON

#### Ubuntu/Debian
```bash
sudo apt-get update
sudo apt-get install libsimdjson-dev
```

#### ä»æºç å®‰è£…
```bash
git clone https://github.com/simdjson/simdjson.git
cd simdjson
mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release
make -j$(nproc)
sudo make install
```

#### macOS (Homebrew)
```bash
brew install simdjson
```

## ğŸ”§ ç¼–è¯‘ä¸è¿è¡Œ

### å¿«é€Ÿå¼€å§‹
```bash
# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœéœ€è¦ï¼‰
cd simdjson_test

# ç¼–è¯‘åŸºç¡€ç¤ºä¾‹
g++ -O3 -std=c++17 test_simdjson.cpp -lsimdjson -o test_simdjson

# è¿è¡ŒåŸºç¡€ç¤ºä¾‹
./test_simdjson
```

### åˆ†æ¨¡å—ç¼–è¯‘

#### é“¾å¼è°ƒç”¨æµ‹è¯•
```bash
cd chain/
make all          # ç¼–è¯‘æ‰€æœ‰é“¾å¼è°ƒç”¨æµ‹è¯•
make run         # è¿è¡ŒåŸºç¡€é“¾å¼è°ƒç”¨æµ‹è¯•
make run_comprehensive  # è¿è¡Œç»¼åˆæµ‹è¯•
```

#### é”™è¯¯å¤„ç†æµ‹è¯•
```bash
cd error/
# ç¼–è¯‘å„ç§é”™è¯¯å¤„ç†æµ‹è¯•
g++ -O3 -std=c++17 simdjson_error_test.cpp -lsimdjson -o error_test
g++ -O3 -std=c++17 simdjson_exception_test.cpp -lsimdjson -o exception_test
```

#### æµå¼å¤„ç†æµ‹è¯•
```bash
cd stream/
make            # ç¼–è¯‘æµå¼å¤„ç†æµ‹è¯•
make run        # è¿è¡Œ NDJSON æµå¤„ç†æµ‹è¯•
```

## ğŸ“š æµ‹è¯•æ¨¡å—è¯¦è§£

### 1. åŸºç¡€è§£æ (`test_simdjson.cpp`)
æ¼”ç¤º SimdJSON çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼š
```cpp
simdjson::ondemand::parser parser;
simdjson::padded_string json_data = R"({"message": "hello world", "status": true})"_padded;
simdjson::ondemand::document doc = parser.iterate(json_data);
```

**å­¦ä¹ è¦ç‚¹**:
- è§£æå™¨åˆå§‹åŒ–
- æ–‡æ¡£è¿­ä»£
- ç±»å‹æ£€æŸ¥
- åŸºç¡€é”™è¯¯å¤„ç†

### 2. é“¾å¼è°ƒç”¨ (`chain/`)
å±•ç¤º SimdJSON å¼ºå¤§çš„é“¾å¼è®¿é—®èƒ½åŠ›ï¼š
```cpp
std::string_view city_name;
error = doc["user"]["address"]["city"].get_string().get(city_name);
```

**ç‰¹æ€§**:
- ä¸€è¡Œä»£ç è®¿é—®æ·±å±‚åµŒå¥—æ•°æ®
- å»¶è¿Ÿè§£æä¼˜åŒ–æ€§èƒ½
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- ç±»å‹å®‰å…¨ä¿éšœ

### 3. é”™è¯¯å¤„ç† (`error/`)
å…¨é¢çš„é”™è¯¯å¤„ç†ç­–ç•¥ï¼š
- **ç®€å•é”™è¯¯å¤„ç†**: åŸºç¡€çš„é”™è¯¯ç æ£€æŸ¥
- **å¼‚å¸¸å¤„ç†**: ä½¿ç”¨å¼‚å¸¸æœºåˆ¶å¤„ç†é”™è¯¯
- **è‡´å‘½é”™è¯¯**: å¤„ç†ä¸¥é‡çš„è§£æé”™è¯¯
- **ç»¼åˆé”™è¯¯æµ‹è¯•**: å¤šç§é”™è¯¯åœºæ™¯çš„æµ‹è¯•

### 4. æµå¼å¤„ç† (`stream/`)
å¤„ç†å¤§å‹å’Œå¤šæ–‡æ¡£ JSON æ•°æ®ï¼š
```cpp
auto stream = parser.iterate_many(ndjson_data);
for (auto doc : stream) {
    // å¤„ç†æ¯ä¸ªæ–‡æ¡£
}
```

**åº”ç”¨åœºæ™¯**:
- æ—¥å¿—æ–‡ä»¶å¤„ç†
- å¤§æ•°æ®é›†è§£æ
- å®æ—¶æ•°æ®æµ
- NDJSON æ ¼å¼æ”¯æŒ

## ğŸ¯ ä½¿ç”¨åœºæ™¯

- **Web API å¼€å‘**: å¿«é€Ÿè§£æ JSON å“åº”
- **æ•°æ®å¤„ç†**: å¤§è§„æ¨¡ JSON æ•°æ®åˆ†æ
- **æ—¥å¿—åˆ†æ**: ç»“æ„åŒ–æ—¥å¿—æ–‡ä»¶å¤„ç†
- **é…ç½®ç®¡ç†**: å¤æ‚é…ç½®æ–‡ä»¶è§£æ
- **å®æ—¶ç³»ç»Ÿ**: ä½å»¶è¿Ÿ JSON å¤„ç†

## ğŸ” æ€§èƒ½å¯¹æ¯”

SimdJSON ç›¸æ¯”ä¼ ç»Ÿ JSON åº“çš„æ€§èƒ½ä¼˜åŠ¿ï¼š
- æ¯” RapidJSON å¿« 2-3 å€
- æ¯” nlohmann/json å¿« 5-10 å€
- å†…å­˜ä½¿ç”¨é‡æ›´ä½
- CPU ç¼“å­˜å‹å¥½

## ğŸ“ æœ€ä½³å®è·µ

1. **ä½¿ç”¨ `padded_string`**: ç¡®ä¿ JSON æ•°æ®æ­£ç¡®å¡«å……
2. **æ£€æŸ¥é”™è¯¯**: å§‹ç»ˆæ£€æŸ¥è§£æå’Œè®¿é—®æ“ä½œçš„é”™è¯¯ç 
3. **ä¿æŒæ•°æ®æœ‰æ•ˆ**: ç¡®ä¿åŸå§‹ JSON æ•°æ®åœ¨ä½¿ç”¨æœŸé—´ä¿æŒæœ‰æ•ˆ
4. **ä½¿ç”¨ `string_view`**: é¿å…ä¸å¿…è¦çš„å­—ç¬¦ä¸²æ‹·è´
5. **åˆç†ä½¿ç”¨é“¾å¼è°ƒç”¨**: åœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ä¸‹ä½¿ç”¨é“¾å¼è®¿é—®

## ğŸ› å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆéœ€è¦ `_padded` åç¼€ï¼Ÿ
A: SimdJSON éœ€è¦åœ¨ JSON å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ å¡«å……å­—èŠ‚ä»¥å®‰å…¨åœ°ä½¿ç”¨ SIMD æŒ‡ä»¤ã€‚

### Q: è§£æåçš„æ•°æ®ä½•æ—¶å¤±æ•ˆï¼Ÿ
A: å½“åŸå§‹çš„ `padded_string` æˆ– `parser` å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œæ‰€æœ‰æ´¾ç”Ÿçš„è§†å›¾éƒ½ä¼šå¤±æ•ˆã€‚

### Q: å¦‚ä½•å¤„ç†å¤§å‹ JSON æ–‡ä»¶ï¼Ÿ
A: ä½¿ç”¨æµå¼ API (`iterate_many`) é€ä¸ªå¤„ç†æ–‡æ¡£ï¼Œé¿å…å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤é—®é¢˜å’Œæ”¹è¿›å»ºè®®ï¼š
1. æŠ¥å‘Š bug æˆ–æ€§èƒ½é—®é¢˜
2. æäº¤æ–°çš„æµ‹è¯•ç”¨ä¾‹
3. å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹
4. ä¼˜åŒ–ç°æœ‰ä»£ç 

## ğŸ“– å‚è€ƒèµ„æº

- [SimdJSON å®˜æ–¹æ–‡æ¡£](https://github.com/simdjson/simdjson)
- [SimdJSON API å‚è€ƒ](https://simdjson.org/api/0.7.0/)
- [æ€§èƒ½åŸºå‡†æµ‹è¯•](https://github.com/simdjson/simdjson#performance-results)
- [C++ JSON åº“æ¯”è¾ƒ](https://github.com/miloyip/nativejson-benchmark)

## ğŸ“„ è®¸å¯è¯

æœ¬æµ‹è¯•é¡¹ç›®éµå¾ª MIT è®¸å¯è¯ã€‚SimdJSON åº“æœ¬èº«é‡‡ç”¨ Apache 2.0 è®¸å¯è¯ã€‚

---

**æ³¨æ„**: è¿™äº›æµ‹è¯•ç¤ºä¾‹ä»…ç”¨äºå­¦ä¹ å’Œæ¼”ç¤ºç›®çš„ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æ—¶ï¼Œè¯·æ ¹æ®å…·ä½“éœ€æ±‚è°ƒæ•´é”™è¯¯å¤„ç†å’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥ã€‚
